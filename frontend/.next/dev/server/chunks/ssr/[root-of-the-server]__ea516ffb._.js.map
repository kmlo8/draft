{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/components/MovieActions.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useAuth } from '@/context/AuthContext';\nimport { likesAPI } from '@/lib/api';\n\ntype Props = {\n  movieId: string;\n  initiallyLiked?: boolean;\n};\n\nexport default function MovieActions({ movieId, initiallyLiked = false }: Props) {\n  const router = useRouter();\n  const { isAuthenticated } = useAuth();\n  const [liked, setLiked] = useState<boolean>(initiallyLiked);\n  const [pending, setPending] = useState<boolean>(false);\n\n  const handleBack = () => {\n    window.history.back();\n  };\n\n  const toggleLike = async () => {\n    if (!isAuthenticated) {\n      router.push('/login');\n      return;\n    }\n\n    if (pending) return;\n    setPending(true);\n    try {\n      if (!liked) {\n        console.log('Frontend: Liking Movie. Type: Movie, ID:', movieId);\n        await likesAPI.create('Movie', movieId);\n        setLiked(true);\n      } else {\n        console.log('Frontend: Unliking Movie. Type: Movie, ID:', movieId);\n        await likesAPI.deleteByTarget('Movie', movieId);\n        setLiked(false);\n      }\n    } catch (e) {\n      console.error('Frontend: Error toggling like:', e);\n      // ignore errors for now\n    } finally {\n      setPending(false);\n    }\n  };\n\n  return (\n    <div className=\"flex items-center gap-3\">\n      <button\n        onClick={handleBack}\n        className=\"px-3 py-2 rounded-lg transition text-sm btn-neutral\"\n      >\n        뒤로가기\n      </button>\n\n      <button\n        onClick={toggleLike}\n        disabled={pending}\n        className={`px-3 py-2 rounded-lg transition text-sm flex items-center gap-2 ${\n          liked ? 'bg-red-600 hover:bg-red-700 text-white' : 'btn-neutral'\n        } disabled:opacity-50`}\n        aria-pressed={liked}\n      >\n        {/* Heart icon */}\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          viewBox=\"0 0 24 24\"\n          fill={liked ? 'currentColor' : 'none'}\n          stroke=\"currentColor\"\n          className=\"w-5 h-5\"\n        >\n          <path\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            strokeWidth={2}\n            d=\"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.737-.715-1.611-2.377-2.737-4.313-2.737C5.099 3.75 3 5.765 3 8.25c0 7.125 9 12 9 12s9-4.875 9-12z\"\n          />\n        </svg>\n        {liked ? '좋아요 취소' : '좋아요'}\n      </button>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AALA;;;;;;AAYe,SAAS,aAAa,EAAE,OAAO,EAAE,iBAAiB,KAAK,EAAS;IAC7E,MAAM,SAAS,IAAA,8LAAS;IACxB,MAAM,EAAE,eAAe,EAAE,GAAG,IAAA,iLAAO;IACnC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gQAAQ,EAAU;IAC5C,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,gQAAQ,EAAU;IAEhD,MAAM,aAAa;QACjB,OAAO,OAAO,CAAC,IAAI;IACrB;IAEA,MAAM,aAAa;QACjB,IAAI,CAAC,iBAAiB;YACpB,OAAO,IAAI,CAAC;YACZ;QACF;QAEA,IAAI,SAAS;QACb,WAAW;QACX,IAAI;YACF,IAAI,CAAC,OAAO;gBACV,QAAQ,GAAG,CAAC,4CAA4C;gBACxD,MAAM,qKAAQ,CAAC,MAAM,CAAC,SAAS;gBAC/B,SAAS;YACX,OAAO;gBACL,QAAQ,GAAG,CAAC,8CAA8C;gBAC1D,MAAM,qKAAQ,CAAC,cAAc,CAAC,SAAS;gBACvC,SAAS;YACX;QACF,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC,kCAAkC;QAChD,wBAAwB;QAC1B,SAAU;YACR,WAAW;QACb;IACF;IAEA,qBACE,6RAAC;QAAI,WAAU;;0BACb,6RAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;0BAID,6RAAC;gBACC,SAAS;gBACT,UAAU;gBACV,WAAW,CAAC,gEAAgE,EAC1E,QAAQ,2CAA2C,cACpD,oBAAoB,CAAC;gBACtB,gBAAc;;kCAGd,6RAAC;wBACC,OAAM;wBACN,SAAQ;wBACR,MAAM,QAAQ,iBAAiB;wBAC/B,QAAO;wBACP,WAAU;kCAEV,cAAA,6RAAC;4BACC,eAAc;4BACd,gBAAe;4BACf,aAAa;4BACb,GAAE;;;;;;;;;;;oBAGL,QAAQ,WAAW;;;;;;;;;;;;;AAI5B","debugId":null}},
    {"offset": {"line": 126, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/components/PersonList.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport Link from 'next/link';\nimport { useAuth } from '@/context/AuthContext';\nimport { likesAPI } from '@/lib/api';\n\ntype ActorItem = {\n  actorId: string;\n  actorName: string;\n  character?: string | null;\n};\n\ntype DirectorItem = {\n  directorId: string;\n  directorName: string;\n};\n\ntype Props = {\n  type: 'Actor' | 'Director';\n  items: ActorItem[] | DirectorItem[];\n};\n\nexport default function PersonList({ type, items }: Props) {\n  const { isAuthenticated } = useAuth();\n  const router = useRouter();\n  const [likedMap, setLikedMap] = useState<Record<string, boolean>>({});\n  const [loadingIds, setLoadingIds] = useState<Record<string, boolean>>({});\n\n  const normalized = useMemo(\n    () =>\n      (items || [])\n        .map((it: any) =>\n          type === 'Actor'\n            ? { id: String(it.actorId), name: it.actorName, sub: it.character ?? null }\n            : { id: String(it.directorId), name: it.directorName, sub: null }\n        )\n        .filter(item => item.id && item.id !== 'undefined'), // Filter out invalid items\n    [items, type]\n  );\n\n  useEffect(() => {\n    if (!isAuthenticated || normalized.length === 0) return;\n\n    const validItems = normalized.filter(n => n.id);\n    if (validItems.length === 0) return;\n\n    const payload = validItems.map((n) => ({ type, id: n.id }));\n    \n    likesAPI\n      .check(payload)\n      .then((res) => {\n        const map: Record<string, boolean> = {};\n        const liked = res.data?.liked || {};\n        for (const n of validItems) {\n          map[n.id] = Boolean(liked[`${type}_${n.id}`]);\n        }\n        setLikedMap(map);\n      })\n      .catch(() => {});\n  }, [isAuthenticated, normalized, type]);\n\n  const toggle = async (id: string) => {\n    if (!isAuthenticated) {\n      router.push('/login');\n      return;\n    }\n    if (loadingIds[id]) return;\n    setLoadingIds((s) => ({ ...s, [id]: true }));\n    try {\n      const isLiked = likedMap[id];\n      if (isLiked) {\n        console.log(`Frontend: Unliking ${type}. Type: ${type}, ID:`, id);\n        await likesAPI.deleteByTarget(type, id);\n      } else {\n        console.log(`Frontend: Liking ${type}. Type: ${type}, ID:`, id);\n        await likesAPI.create(type, id);\n      }\n      setLikedMap((s) => ({ ...s, [id]: !isLiked }));\n    } catch (e) {\n      console.error('Frontend: Error toggling like:', e);\n      // ignore\n    } finally {\n      setLoadingIds((s) => ({ ...s, [id]: false }));\n    }\n  };\n\n  return (\n    <div className=\"divide-y divide-white/10 rounded-lg overflow-hidden bg-white/5\">\n      {normalized.map((n) => (\n        <div key={n.id} className=\"flex items-center justify-between px-4 py-3\">\n          <Link href={type === 'Actor' ? `/actor/${n.id}` : `/director/${n.id}`} className=\"min-w-0\">\n            <div className=\"font-medium text-gray-100 truncate\" title={n.name}>\n              {n.name}\n            </div>\n            {n.sub ? (\n              <div className=\"text-sm text-gray-400 truncate\" title={n.sub}>\n                {n.sub}\n              </div>\n            ) : null}\n          </Link>\n          <button\n            onClick={() => toggle(n.id)}\n            disabled={Boolean(loadingIds[n.id])}\n            className={`px-3 py-1.5 rounded-md text-sm flex items-center gap-2 transition ${\n              likedMap[n.id] ? 'bg-red-600 hover:bg-red-700 text-white' : 'bg-white/10 hover:bg-white/20'\n            } disabled:opacity-50`}\n            aria-pressed={likedMap[n.id]}\n          >\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 24 24\"\n              fill={likedMap[n.id] ? 'currentColor' : 'none'}\n              stroke=\"currentColor\"\n              className=\"w-5 h-5\"\n            >\n              <path\n                strokeLinecap=\"round\"\n                strokeLinejoin=\"round\"\n                strokeWidth={2}\n                d=\"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.737-.715-1.611-2.377-2.737-4.313-2.737C5.099 3.75 3 5.765 3 8.25c0 7.125 9 12 9 12s9-4.875 9-12z\"\n              />\n            </svg>\n            {likedMap[n.id] ? '좋아요 취소' : '좋아요'}\n          </button>\n        </div>\n      ))}\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}