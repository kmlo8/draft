{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/context/AuthContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from 'react';\nimport { setAccessToken as setApiAccessToken, userAPI } from '@/lib/api';\n\ninterface User {\n  id: string;\n  email: string;\n  darkMode: boolean;\n  preferredGenres?: string[];\n  preferredActors?: string[];\n  preferredDirectors?: string[];\n}\n\ninterface AuthContextType {\n  user: User | null;\n  isAuthenticated: boolean;\n  login: (token: string, userData: User) => void;\n  logout: () => void;\n  updateUser: (userData: Partial<User>) => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport const AuthProvider = ({ children }: { children: ReactNode }) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [accessToken, setAccessToken] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const isAuthenticated = !!accessToken;\n\n  const logout = useCallback(async () => {\n    try {\n      await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/auth/logout`, {\n        method: 'POST',\n        credentials: 'include',\n        headers: { 'Authorization': `Bearer ${accessToken}` }\n      });\n    } catch (error) {\n      console.error('Logout error:', error);\n    } finally {\n      setAccessToken(null);\n      setApiAccessToken(null);\n      setUser(null); // Explicitly clear user state\n    }\n  }, [accessToken]);\n\n  useEffect(() => {\n    const refreshToken = async () => {\n      try {\n        const response = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/auth/refresh`, {\n          method: 'POST',\n          credentials: 'include'\n        });\n\n        if (response.ok) {\n          const data = await response.json();\n          setAccessToken(data.accessToken);\n          setApiAccessToken(data.accessToken);\n        }\n      } catch (error) {\n        console.error('Initial refresh failed:', error);\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    void refreshToken();\n  }, []);\n\n  useEffect(() => {\n    const fetchProfile = async () => {\n      if (isAuthenticated) {\n        try {\n          const response = await userAPI.getProfile();\n          setUser(response.data.user);\n          console.log('User data loaded:', response.data.user);\n        } catch (error) {\n          console.error('Failed to fetch profile, logging out:', error);\n          void logout();\n        }\n      }\n    };\n    void fetchProfile();\n  }, [isAuthenticated, logout]);\n\n  const login = (token: string, userData: User) => {\n    setAccessToken(token);\n    setApiAccessToken(token);\n    setUser(userData);\n    console.log('User logged in:', userData);\n  };\n\n  const updateUser = async (userData: Partial<User>) => {\n    if (!user) return;\n\n    const oldUser = user;\n    // Correctly merge the new data with the existing user object\n    const updatedUser = { ...oldUser, ...userData };\n    setUser(updatedUser);\n\n    try {\n      const response = await userAPI.updateProfile(userData);\n      setUser(response.data.user);\n      console.log('User data saved and updated:', response.data.user);\n    } catch (error) {\n      console.error('Failed to update user data:', error);\n      setUser(oldUser); // Revert on error\n    }\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user,\n        isAuthenticated,\n        login,\n        logout,\n        updateUser\n      }}\n    >\n      {!isLoading && children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAsBA,MAAM,4BAAc,IAAA,qQAAa,EAA8B;AAExD,MAAM,eAAe,CAAC,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gQAAQ,EAAc;IAC9C,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,gQAAQ,EAAgB;IAC9D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,gQAAQ,EAAC;IAE3C,MAAM,kBAAkB,CAAC,CAAC;IAE1B,MAAM,SAAS,IAAA,mQAAW,EAAC;QACzB,IAAI;YACF,MAAM,MAAM,6DAAmC,gBAAgB,CAAC,EAAE;gBAChE,QAAQ;gBACR,aAAa;gBACb,SAAS;oBAAE,iBAAiB,CAAC,OAAO,EAAE,aAAa;gBAAC;YACtD;QACF,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,iBAAiB;QACjC,SAAU;YACR,eAAe;YACf,IAAA,2KAAiB,EAAC;YAClB,QAAQ,OAAO,8BAA8B;QAC/C;IACF,GAAG;QAAC;KAAY;IAEhB,IAAA,iQAAS,EAAC;QACR,MAAM,eAAe;YACnB,IAAI;gBACF,MAAM,WAAW,MAAM,MAAM,6DAAmC,iBAAiB,CAAC,EAAE;oBAClF,QAAQ;oBACR,aAAa;gBACf;gBAEA,IAAI,SAAS,EAAE,EAAE;oBACf,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,eAAe,KAAK,WAAW;oBAC/B,IAAA,2KAAiB,EAAC,KAAK,WAAW;gBACpC;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,2BAA2B;YAC3C,SAAU;gBACR,aAAa;YACf;QACF;QACA,KAAK;IACP,GAAG,EAAE;IAEL,IAAA,iQAAS,EAAC;QACR,MAAM,eAAe;YACnB,IAAI,iBAAiB;gBACnB,IAAI;oBACF,MAAM,WAAW,MAAM,oKAAO,CAAC,UAAU;oBACzC,QAAQ,SAAS,IAAI,CAAC,IAAI;oBAC1B,QAAQ,GAAG,CAAC,qBAAqB,SAAS,IAAI,CAAC,IAAI;gBACrD,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,yCAAyC;oBACvD,KAAK;gBACP;YACF;QACF;QACA,KAAK;IACP,GAAG;QAAC;QAAiB;KAAO;IAE5B,MAAM,QAAQ,CAAC,OAAe;QAC5B,eAAe;QACf,IAAA,2KAAiB,EAAC;QAClB,QAAQ;QACR,QAAQ,GAAG,CAAC,mBAAmB;IACjC;IAEA,MAAM,aAAa,OAAO;QACxB,IAAI,CAAC,MAAM;QAEX,MAAM,UAAU;QAChB,6DAA6D;QAC7D,MAAM,cAAc;YAAE,GAAG,OAAO;YAAE,GAAG,QAAQ;QAAC;QAC9C,QAAQ;QAER,IAAI;YACF,MAAM,WAAW,MAAM,oKAAO,CAAC,aAAa,CAAC;YAC7C,QAAQ,SAAS,IAAI,CAAC,IAAI;YAC1B,QAAQ,GAAG,CAAC,gCAAgC,SAAS,IAAI,CAAC,IAAI;QAChE,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,+BAA+B;YAC7C,QAAQ,UAAU,kBAAkB;QACtC;IACF;IAEA,qBACE,6RAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA;YACA;QACF;kBAEC,CAAC,aAAa;;;;;;AAGrB;AAEO,MAAM,UAAU;IACrB,MAAM,UAAU,IAAA,kQAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/context/ThemeContext.tsx"],"sourcesContent":["'use client';\n\nimport React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { useAuth } from './AuthContext';\n\ninterface ThemeContextType {\n  darkMode: boolean;\n  toggleDarkMode: () => void;\n}\n\nconst ThemeContext = createContext<ThemeContextType | undefined>(undefined);\n\nexport const ThemeProvider = ({ children }: { children: ReactNode }) => {\n  const { user, accessToken } = useAuth();\n  const [darkMode, setDarkMode] = useState(true); // Default to dark mode\n\n  // Sync with user preferences\n  useEffect(() => {\n    if (user && user.darkMode !== undefined) {\n      setDarkMode(user.darkMode);\n    }\n  }, [user]);\n\n  // Apply theme classes to html element\n  useEffect(() => {\n    const el = document.documentElement;\n    if (darkMode) {\n      el.classList.add('dark');\n      el.classList.remove('light');\n    } else {\n      el.classList.remove('dark');\n      el.classList.add('light');\n    }\n  }, [darkMode]);\n\n  const toggleDarkMode = async () => {\n    const newDarkMode = !darkMode;\n    setDarkMode(newDarkMode);\n\n    // Update on server if authenticated\n    if (accessToken) {\n      try {\n        await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/user/profile`, {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${accessToken}`\n          },\n          credentials: 'include',\n          body: JSON.stringify({ darkMode: newDarkMode })\n        });\n      } catch (error) {\n        console.error('Failed to update dark mode preference:', error);\n      }\n    }\n  };\n\n  return (\n    <ThemeContext.Provider value={{ darkMode, toggleDarkMode }}>\n      {children}\n    </ThemeContext.Provider>\n  );\n};\n\nexport const useTheme = () => {\n  const context = useContext(ThemeContext);\n  if (context === undefined) {\n    throw new Error('useTheme must be used within a ThemeProvider');\n  }\n  return context;\n};\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAUA,MAAM,6BAAe,IAAA,qQAAa,EAA+B;AAE1D,MAAM,gBAAgB,CAAC,EAAE,QAAQ,EAA2B;IACjE,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,GAAG,IAAA,iLAAO;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,gQAAQ,EAAC,OAAO,uBAAuB;IAEvE,6BAA6B;IAC7B,IAAA,iQAAS,EAAC;QACR,IAAI,QAAQ,KAAK,QAAQ,KAAK,WAAW;YACvC,YAAY,KAAK,QAAQ;QAC3B;IACF,GAAG;QAAC;KAAK;IAET,sCAAsC;IACtC,IAAA,iQAAS,EAAC;QACR,MAAM,KAAK,SAAS,eAAe;QACnC,IAAI,UAAU;YACZ,GAAG,SAAS,CAAC,GAAG,CAAC;YACjB,GAAG,SAAS,CAAC,MAAM,CAAC;QACtB,OAAO;YACL,GAAG,SAAS,CAAC,MAAM,CAAC;YACpB,GAAG,SAAS,CAAC,GAAG,CAAC;QACnB;IACF,GAAG;QAAC;KAAS;IAEb,MAAM,iBAAiB;QACrB,MAAM,cAAc,CAAC;QACrB,YAAY;QAEZ,oCAAoC;QACpC,IAAI,aAAa;YACf,IAAI;gBACF,MAAM,MAAM,6DAAmC,iBAAiB,CAAC,EAAE;oBACjE,QAAQ;oBACR,SAAS;wBACP,gBAAgB;wBAChB,iBAAiB,CAAC,OAAO,EAAE,aAAa;oBAC1C;oBACA,aAAa;oBACb,MAAM,KAAK,SAAS,CAAC;wBAAE,UAAU;oBAAY;gBAC/C;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,0CAA0C;YAC1D;QACF;IACF;IAEA,qBACE,6RAAC,aAAa,QAAQ;QAAC,OAAO;YAAE;YAAU;QAAe;kBACtD;;;;;;AAGP;AAEO,MAAM,WAAW;IACtB,MAAM,UAAU,IAAA,kQAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 225, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 244, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,+JACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/aaaaaaaaaaa/draft/frontend/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,+JACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0],"debugId":null}}]
}